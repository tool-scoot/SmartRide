<!DOCTYPE html>
<html>
<title>Page 2</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/w3.css">
<link rel="stylesheet" href="css/extras.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css/smartride.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<body id = "ridescreen" onload="setUp()">

  <!-- all body code goes in here, head code goes in existing header section -->
  <!--<iframe id="googlemaps" src="https://www.google.com/maps/embed?pb=!1m24!1m8!1m3!1d21581.7776616572!2d-87.69326551159546!3d42.05448974302627!3m2!1i1024!2i768!4f13.1!4m13!3e0!4m5!1s0x880fda991e0909af%3A0x84c2b7d444da08fd!2s560+Lincoln+Street%2C+Evanston%2C+IL!3m2!1d42.0612942!2d-87.6757566!4m5!1s0x880fd00adb51d875%3A0xd00006d0c19df955!2sFoster-Walker+Residential+Complex%2C+Evanston%2C+IL!3m2!1d42.0529122!2d-87.6786365!5e0!3m2!1sen!2sus!4v1558985067723!5m2!1sen!2sus" width="400" height="700" scrolling="no" frameborder="0" style="border:0" allowfullscreen></iframe>-->
  <iframe id="googlemaps" src="https://www.google.com/maps/embed?pb=!1m24!1m8!1m3!1d101365.41894219024!2d-87.69432395839056!3d42.051458731486626!3m2!1i1024!2i768!4f13.1!4m13!3e0!4m5!1s0x880fda991e0909af%3A0x84c2b7d444da08fd!2s560+Lincoln+Street%2C+Evanston%2C+IL!3m2!1d42.0612942!2d-87.6757566!4m5!1s0x880fd00adb51d875%3A0xd00006d0c19df955!2sFoster-Walker+Residential+Complex%2C+Evanston%2C+IL!3m2!1d42.0529122!2d-87.6786365!5e0!3m2!1sen!2sus!4v1558988728080!5m2!1sen!2sus" width="400" height="700" scrolling="no" frameborder="0" style="border:0" allowfullscreen></iframe>
      <!--<div id = "rideheader">-->
        <a onclick="saveLastPage()" href='page2.html'><i id="settings2" class="fa fa-cog"></i></a> <!-- this is the three bars icon for the options slide ba, we need to do an href-->
        <a href='index.html'> <i id="home" class="fa fa-home"></i> </a>
      <!--</div>-->
      <!--I didn't see the point of this div so I commented it out for now-->

      <div id = "rideicons">
        <!--<div id = "ridetitle"> RIDE </div>-->
        <br>
        <br>
        <br>
        <br>
          <div class="transport" id = "option1">
            <p>Uber</p>
            <article id="uberinfo" data-eta="15" data-price="5">
            </article>
              </div>
          <hr id="break">
          <div class="transport" id = "option2">
              <p>Lyft</p>
              <article id="lyftinfo" data-eta="25" data-price="6">
                </article>
              
          </div>
          <hr id="break">
          <div class="transport" id = "option3">
            <p>SafeRide</p>
            <article id="saferideinfo" data-eta="30" data-price="0">
                </article>
            
          </div>
          <hr id="break">
          <div class="transport" id = "option4">
              <p>CTA</p>
              <article id="ctainfo" data-eta="5" data-price="2">
                  </article>
              
          </div>
        </div>

<script>

  function setUp(){
    //set up the display order
    let lyfteta = document.getElementById("lyftinfo").getAttribute("data-eta");
    let lyftprice = document.getElementById("lyftinfo").getAttribute("data-price");
    let ubereta = document.getElementById("uberinfo").getAttribute("data-eta");
    let uberprice = document.getElementById("uberinfo").getAttribute("data-price");
    let sreta = document.getElementById("saferideinfo").getAttribute("data-eta");
    let srprice = document.getElementById("saferideinfo").getAttribute("data-price");
    let ctaeta = document.getElementById("ctainfo").getAttribute("data-eta");
    let ctaprice = document.getElementById("ctainfo").getAttribute("data-price");
    let uberstoredin = 0;
    let lyftstoredin = 0;
    let srstoredin = 0;
    let ctastoredin = 0;
    let sortBy = localStorage.getItem('sortBy');
    if (sortBy == "By ETA"){
      let etas = [lyfteta, ubereta, sreta, ctaeta];
      etas.sort(function(a, b){return a-b});
      console.log(etas);
      for (let i = 0; i < etas.length; i++){
        if (etas[i] == ubereta){
          document.getElementById("option"+(i+1)).innerHTML = 
          `<p id = "ridetitle"><a id = "travellink" href="">Uber</a></p>
            <article id="uberinfo" data-eta="15" data-price="5">
            </article>
            
              <p id = "rideinfo">ETA: 15 min || Price: $5.00</p>`;
          uberstoredin = i;
        }
        else if (etas[i] == lyfteta){
          document.getElementById("option"+(i+1)).innerHTML = 
              `<p id = "ridetitle"><a id = "travellink" href="">Lyft</a></p>
              <article id="lyftinfo" data-eta="25" data-price="6">
                </article>
               
              <p id = "rideinfo">ETA: 25 min || Price: $6.00</p>`;
          lyftstoredin = i;
        }
        else if (etas[i] == sreta){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p id = "ridetitle"><a id = "travellink" href="">SafeRide</a></p>
            <article id="saferideinfo" data-eta="30" data-price="0">
                </article>
                
            <p id = "rideinfo">ETA: 30 min || Price: $0.00</p>`;
          srstoredin = i;
        }
        else if (etas[i] == ctaeta){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p id = "ridetitle"><a id = "travellink" href="">CTA</a></p>
              <article id="ctainfo" data-eta="5" data-price="2">
                  </article>
                  
              <p id = "rideinfo">ETA: 5 min || Price: $2.00</p>`;
          ctastoredin = i;
        }
      }
    }
    else if (sortBy == "By Price"){
      let prices = [lyftprice, uberprice, srprice, ctaprice];
      prices.sort(function(a, b){return a-b});
      console.log(prices);
      for (let i = 0; i < prices.length; i++){
        if (prices[i] == uberprice){
          document.getElementById("option"+(i+1)).innerHTML = 
          `<p><a id = "travellink" href="">Uber</a></p>
            <article id="uberinfo" data-eta="15" data-price="5">
            </article>
            
            <p id = "rideinfo">Price: $5.00 || ETA: 15 min</p>`;
          uberstoredin = i;
        }
        else if (prices[i] == lyftprice){
          document.getElementById("option"+(i+1)).innerHTML = 
              `<p><a id = "travellink" href="">Lyft</a></p>
              <article id="lyftinfo" data-eta="25" data-price="4">
                </article>
               
                <p id = "rideinfo">Price: $6.00 || ETA: 25 min</p>`;
          lyftstoredin = i;
        }
        else if (prices[i] == srprice){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p><a id = "travellink" href="">SafeRide</a></p>
            <article id="saferideinfo" data-eta="30" data-price="0">
                </article>

                <p id = "rideinfo">Price: $0.00 || ETA: 30 min</p>`;
          srstoredin = i;
        }
        else if (prices[i] == ctaprice){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p><a id = "travellink" href="">CTA</a></p>
              <article id="ctainfo" data-eta="5" data-price="2">
                  </article>
                  
            <p id = "rideinfo">Price: $2.00 || ETA: 5 min</p>`;
          ctastoredin = i;
        }
      }
    }
    else;

    //set up the visibility
    if (!(JSON.parse(localStorage.getItem('Transport1'))))
      document.getElementById("option"+(uberstoredin+1)).style.display = "none";
    if (!(JSON.parse(localStorage.getItem('Transport2'))))
      document.getElementById("option"+(lyftstoredin+1)).style.display = "none";
    if (!(JSON.parse(localStorage.getItem('Transport3'))))
      document.getElementById("option"+(srstoredin+1)).style.display = "none";
    if (!(JSON.parse(localStorage.getItem('Transport4'))))
      document.getElementById("option"+(ctastoredin+1)).style.display = "none";
  }

  function saveLastPage(){
          localStorage.setItem("cameFrom", "page3.html");
  }

</script>
</body>
</html>
