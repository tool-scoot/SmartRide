<!DOCTYPE html>
<html>
<title>Page 2</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/w3.css">
<link rel="stylesheet" href="css/extras.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css/smartride.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="saferide.js"></script>

<body onload = "setUp()">
    <div id = "ridescreen" style="overflow: auto; height: 900px">
        <div class = "head">
          <p class="title"> Ride </p>
          <a href='index.html'><i id="close" class="fa fa-arrow-circle-left"></i></a>
        </div>
        <hr id="divisor">
        
        <!--<a href='/page2.html'><i id="settings2" class="glyphicon glyphicon-tasks"></i></a>
        <a href='/page4.html'><i id="scroll_down" class="fa fa-chevron-circle-down"></i></a>-->
        
          <div class="transport" id = "option1">
            <p>Uber</p>
            <article id="uberinfo" data-eta="15" data-price="50">
            </article>
              <img class="logo" src="project_5_files/images/uber logo.png">
          </div>

          <div class="transport" id = "option2">
              <p>Lyft</p>
              <article id="lyftinfo" data-eta="25" data-price="40">
                </article>
              <img class="logo" src="project_5_files/images/lyft logo.png">
          </div>

          <div class="transport" id = "option3">
            <p>SafeRide</p>
            <article id="saferideinfo" data-eta="30" data-price="0">
                </article>
            <img class="logo" src="project_5_files/images/saferide  logo.jpg">
          </div>

          <div class="transport" id = "option4">
              <p>CTA</p>
              <article id="ctainfo" data-eta="5" data-price="20">
                  </article>
              <img class="logo" src="project_5_files/images/cta logo.png">
          </div>
    
      
    </div>
</body>
<script>
  function setUp(){
    //set up the display order
    let lyfteta = document.getElementById("lyftinfo").getAttribute("data-eta");
    let lyftprice = document.getElementById("lyftinfo").getAttribute("data-price");
    let ubereta = document.getElementById("uberinfo").getAttribute("data-eta");
    let uberprice = document.getElementById("uberinfo").getAttribute("data-price");
    let sreta = document.getElementById("saferideinfo").getAttribute("data-eta");
    let srprice = document.getElementById("saferideinfo").getAttribute("data-price");
    let ctaeta = document.getElementById("ctainfo").getAttribute("data-eta");
    let ctaprice = document.getElementById("ctainfo").getAttribute("data-price");
    let uberstoredin = 0;
    let lyftstoredin = 0;
    let srstoredin = 0;
    let ctastoredin = 0;
    let sortBy = localStorage.getItem('sortBy');
    if (sortBy == "By ETA"){
      let etas = [lyfteta, ubereta, sreta, ctaeta];
      etas.sort(function(a, b){return a-b});
      console.log(etas);
      for (let i = 0; i < etas.length; i++){
        if (etas[i] == ubereta){
          document.getElementById("option"+(i+1)).innerHTML = 
          `<p id = "ridetitle"><a id = "travellink" href="">Uber</a></p>
            <article id="uberinfo" data-eta="15" data-price="50">
            </article>
            <a href = ""><img class="logo" src="/images/uber logo.png"></a>
              <p id = "rideinfo">ETA: 15 min || Price: $50.00</p>`;
          uberstoredin = i;
        }
        else if (etas[i] == lyfteta){
          document.getElementById("option"+(i+1)).innerHTML = 
              `<p id = "ridetitle"><a id = "travellink" href="">Lyft</a></p>
              <article id="lyftinfo" data-eta="25" data-price="40">
                </article>
                <a href = ""><img class="logo" src="/images/lyft logo.png"></a>
              <p id = "rideinfo">ETA: 25 min || Price: $40.00</p>`;
          lyftstoredin = i;
        }
        else if (etas[i] == sreta){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p id = "ridetitle"><a id = "travellink" href="">SafeRide</a></p>
            <article id="saferideinfo" data-eta="30" data-price="0">
                </article>
                <a href = ""><img class="logo" src="/images/saferide  logo.jpg"></a>
            <p id = "rideinfo">ETA: 30 min || Price: $0.00</p>`;
          srstoredin = i;
        }
        else if (etas[i] == ctaeta){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p id = "ridetitle"><a id = "travellink" href="">CTA</a></p>
              <article id="ctainfo" data-eta="5" data-price="20">
                  </article>
                  <a href = ""><img class="logo" src="/images/cta logo.png"></a>
              <p id = "rideinfo">ETA: 5 min || Price: $20.00</p>`;
          ctastoredin = i;
        }
      }
    }
    else if (sortBy == "By Price"){
      let prices = [lyftprice, uberprice, srprice, ctaprice];
      prices.sort(function(a, b){return a-b});
      console.log(prices);
      for (let i = 0; i < prices.length; i++){
        if (prices[i] == uberprice){
          document.getElementById("option"+(i+1)).innerHTML = 
          `<p><a id = "travellink" href="">Uber</a></p>
            <article id="uberinfo" data-eta="15" data-price="50">
            </article>
            <a href = ""><img class="logo" src="/images/uber logo.png"></a>
            <p id = "rideinfo">Price: $50.00 || ETA: 15 min</p>`;
          uberstoredin = i;
        }
        else if (prices[i] == lyftprice){
          document.getElementById("option"+(i+1)).innerHTML = 
              `<p><a id = "travellink" href="">Lyft</a></p>
              <article id="lyftinfo" data-eta="25" data-price="40">
                </article>
                <a href = ""><img class="logo" src="/images/lyft logo.png"></a>
                <p id = "rideinfo">Price: $40.00 || ETA: 25 min</p>`;
          lyftstoredin = i;
        }
        else if (prices[i] == srprice){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p><a id = "travellink" href="">SafeRide</a></p>
            <article id="saferideinfo" data-eta="30" data-price="0">
                </article>
                <a href = ""><img class="logo" src="/images/saferide  logo.jpg"></a>
                <p id = "rideinfo">Price: $0.00 || ETA: 30 min</p>`;
          srstoredin = i;
        }
        else if (prices[i] == ctaprice){
          document.getElementById("option"+(i+1)).innerHTML =
          `<p><a id = "travellink" href="">CTA</a></p>
              <article id="ctainfo" data-eta="5" data-price="20">
                  </article>
            <a href = ""><img class="logo" src="/images/cta logo.png"></a>
            <p id = "rideinfo">Price: $20.00 || ETA: 5 min</p>`;
          ctastoredin = i;
        }
      }
    }
    else;

    //set up the visibility
    if (!(JSON.parse(localStorage.getItem('Transport1'))))
      document.getElementById("option"+(uberstoredin+1)).style.display = "none";
    if (!(JSON.parse(localStorage.getItem('Transport2'))))
      document.getElementById("option"+(lyftstoredin+1)).style.display = "none";
    if (!(JSON.parse(localStorage.getItem('Transport3'))))
      document.getElementById("option"+(srstoredin+1)).style.display = "none";
    if (!(JSON.parse(localStorage.getItem('Transport4'))))
      document.getElementById("option"+(ctastoredin+1)).style.display = "none";
  }

</script>
</html>
